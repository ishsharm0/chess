<!DOCTYPE html>
<html>
<head>
    <title>Chess Game</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
</head>
<body data-turn="{{ turn }}">
    <div class="container">
        <div class="chess-container">
            <div class="board-container">
                <table class="chess-board">
                    {% for i in range(8) %}
                    <tr>
                        {% for j in range(8) %}
                        <td id="cell-{{ i*8 + j }}" class="{{ 'black' if (i+j) % 2 else 'white' }}">
                            {{ board[i*8 + j] if board[i*8 + j] else ' ' }}
                        </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </table>
            </div>
            <div class="info-container">
                <h1>Chess</h1>
                {% for message, category in get_flashed_messages(with_categories=true) %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
                <div class="controls">
                    {% if promote %}
                    <form action="{{ url_for('active') }}" method="post" class="promotion-form">
                        <label for="promotion_piece">Promote to:</label>
                        <select name="promotion_piece" id="promotion_piece" class="promotion-dropdown">
                            <option value="QUEEN">Queen</option>
                            <option value="ROOK">Rook</option>
                            <option value="BISHOP">Bishop</option>
                            <option value="KNIGHT">Knight</option>
                        </select>
                        <button type="submit">Promote</button>
                    </form>
                    {% else %}
                    <form id="move-form">
                        <input type="text" name="move" placeholder="e.g., P6 f6">
                        <button type="submit">Make Move</button>
                        <button type="button" onclick="resetGame();">Reset Game</button>
                    </form>
                    {% endif %}
                </div>
                <div class="instructions">
                    <p>To castle, type <strong>CASTLE</strong>.</p>
                    <p class="turn-display">Current turn: <span>{{ turn }}</span></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
